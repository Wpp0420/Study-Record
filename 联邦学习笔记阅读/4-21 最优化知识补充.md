# 4-21 最优化知识补充

# 1.Lipschitz Condition.

## 情况：

==凸优化课程的时候，老师讲过我们对优化函数的期望大概是：它是凸的，它比较凸（强凸，否则过于平滑的会收敛得很慢），它不那么凸（收敛太快，比较尖锐的时候也很难优化）。所以我们平时看见一些Lipschitz和Strong Convexity的概念也能够理解了。==

![image-20240421202325350](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421202325350.png)

**在我看来，Lipschitz continuous 用在函数值上是为了不让函数值变化的太快；用在导函数上，是为了不让导函数变化的太快；用在Hessian上，是为了让Hessian不变化的太快。但他们都导致了一个很有意思的结果：这个Lipschitz continuous不管用在什么上，都使的函数被多项式上下夹逼，一方面便于我们处理，另一方面至少我们能控制一下函数的包络信息**

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-3e5265360d2cb61a75cef67e47c17747_1440w.webp)

如果函数𝑓符合Lipschitz continuous会怎么样呢

**说明如果函数是是Lipschitz continuous gradient，固定𝑥,对于这个关于𝑦的函数，那么这个函数的上方和下方是被一个二次函数Bounded！**

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-6c30fae55406a177e706164dfa6d5efe_1440w.webp)

**说明如果函数是是Lipschitz continuous Hessian，固定𝑥,对于这个关于𝑦的函数**，**那么这个函数的上方和下方是被一个三次函数Bounded！**

粗暴一点的看的话：**感觉就像，一上一下，强迫你的目标函数长得像一个二次函数.**

如果梯度是L-Lipschitz的，就有了一个**二次函数的上界**：

𝑓(𝑥)⩽𝑓(𝑥0)+<∇𝑓(𝑥0),𝑥−𝑥0>+𝐿2‖𝑥−𝑥0‖2∀𝑥

如果是 𝜇 -strongly convex的，就有了一个**二次函数的下界**：

𝑓(𝑥0)+<∇𝑓(𝑥0),𝑥−𝑥0>+𝜇2‖𝑥−𝑥0‖2⩽𝑓(𝑥)∀𝑥

画个示意图，大概长这个样子：

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-05d1db0739fa5df64118c8fd2ac44373_1440w.webp)



**由于被迫长成一个二次函数的样子，于是很多算法在 𝜇 -strongly convex + Gradient L-Lipschiz下都有比较好的表现。**

## 证明：

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-3930ddde070ea3310724dc1864ba9eb7_1440w.webp)

（不等式1：积分的绝对值<绝对值的积分）

（不等式2：乘积的绝对值<绝对值的乘积）

（不等式3：拉普拉子梯度条件）

![image-20240421202325350](file://C:/Users/WP/AppData/Roaming/Typora/typora-user-images/image-20240421202325350.png?lastModify=1713702849)

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-037d4f8529a6a91d179a1618612eab02_1440w.webp)

# 2.收敛速度

## 1.什么是收敛速度

对于一个 Optimization 的问题，只考虑一阶的话，我们希望得到 Convergence Analysis 无外乎三种

- 最差的情况下，我们需要迭代多少次，才能保证当前得到的点𝑥𝑇与最小值点𝑥⋆的距离**一定**小于𝜖

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-f2234e2daded4e6745d9d18fa7304f66_1440w.webp)



- 最差的情况下，需要迭代多少次，才能保证当前得到的函数值𝑓(𝑥𝑇)与函数的最小值的差**一定**小于𝜖

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-770bf65f0fc15f9353aff4f8a44e0aa7_1440w.webp)

- 最差的情况下，需要迭代多少次，才能保证当前得到的导数𝑓′(𝑥𝑇)**一定**小于𝜖 （𝑓′(𝑥𝑇) 接近零，在凸函数里就是接近最小值点 ）

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-036d16efd737e10a93ce8e4f7de2a051_1440w.webp)

![image-20240421204230051](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421204230051.png)

![image-20240421205453781](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421205453781.png)

## 2.常见收敛速度

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-5d47ad7211080e94ac4f6575699a47d6_1440w.webp)

它们的快慢关系是 **Sublinear < Linear < Quadratic**, Quadratic最快了。 稍微画的图，感受一下Sublinear有多慢好了。。。x轴是要求的精度𝜖<𝑏𝑟>，y轴是所需要的迭代次数。

<img src="Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-adf9d7cc7209e91a0e042872e3ae1b97_1440w.webp" alt="img" style="zoom:33%;" />

## 3.怎样推导出收敛速度（举例）

最初证明（最后一次==值==**==（距离最优解的距离）==**小于最初==值==**==（距离最优解的距离）==***==（与最终迭代次数和精度有关）==）

最后证明（T>=f(1/k)）最坏情况下==迭代次数==一定==大于==（f(1/k)）（与==精度有关==）

### 1.Sublinear Convergence

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-ad0465a8092d439d3c79d55e03f8732a_1440w.webp)

<img src="Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421211139039.png" alt="image-20240421211139039"  />

### 2. **Linear Convergence**

这种情况下，你一般会得到这样的递推公式

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-6d1406a96d19b39c546f12710636f4a1_1440w.webp)

注意这里𝑞<1，一直递推下去，就能得到

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-db56020737e4e0cccf51fa568023b502_1440w.webp)

![image-20240421212055407](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421212055407.png)

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-8e56177fe19f4c8ab66e5a2ba8461b22_1440w.webp)

然后两边都除以log⁡𝑞， 注意𝑞<1，所以log⁡𝑞<0, 不等号要改变方向



![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-94a530ca02c6df3c9c926eac97a59cec_1440w.webp)

公式（ii）因为log⁡𝑞<0，而且𝑞是常数，所以直接写个𝐶替代了。

**所以Linear Convergence 的Order 是**𝑂(log⁡(1𝜖))，

**对应推导公式是**‖𝑥𝑡+1−𝑥⋆‖⩽𝑞‖𝑥𝑡−𝑥⋆‖。

### **3.Quadratic Convergence**

这种情况下，你一般会得到这样的递推公式

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-92d21675aa9596d7b900dac98245caee_1440w.webp)

然后我们一路迭代下去

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-e0499acf194faaa1b296a828fd85bc94_1440w.webp)

![image-20240421212401402](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421212401402.png)

![img](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/v2-2db6df134309d2ea7d66ec1404ba16c8_1440w.webp)

![image-20240421212456252](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421212456252.png)

### 4.梯度下降法在不同情况下的收敛（强凸/凸/非凸）

![image-20240421212743939](Piuture_4-21%20%E6%9C%80%E4%BC%98%E5%8C%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/image-20240421212743939.png)

### ==5.梯度下降法在不同情况下的收敛（证明）==

https://zhuanlan.zhihu.com/p/66229525

### ==6.什么是梯度下降中的线性收敛==